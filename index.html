<!DOCTYPE html>
<html>
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" />

        <!-- Leaflet CSS file -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />

        <!-- Leaflet JavaScript file -->
        <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>

        <style>
            /* CSS */

            #map {
              margin: auto;
              width: 1300px;
              height: 600px;
            }
        </style>

        <title>Information Page</title>
    </head>
    <body>

        <!-- HTML --> <!--Make a logo?-->
        <nav class="navbar navbar-expand-lg bg-body-tertiary">
            <div class="container-fluid">
              <a class="navbar-brand" href="#"></a>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                  <li class="nav-item">
                    <a class="nav-link" href="home.html">Account</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="#">Information</a>
                  </li>
                </ul>
                <!-- <form class="d-flex" role="search"> //Optional
                  <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                  <button class="btn btn-outline-success" type="submit">Search</button>
                </form> -->
              </div>
            </div>
          </nav>



          <!-- main -->
          <div style="padding: 10px 30px;" >
            <h1 id="pName"></h1>

            <!-- Enter pet name on page -->
            <input placeholder="pet name" type="text" id="petName">
            <br>
            <br>

            <input placeholder="pet description" type="text" id="description">

            <br>
            <br>

            <p>Type in coordinates of your pet:</p>


            <!-- Longitude -->
            <p>(If South, please put a negative sign "-"):</p>
            <input placeholder="longitude" type="text" id="coordLong">
            <br>
            <br>

            <!-- Latitude -->
            <p>(If East, please put a negative sign "-"):</p>
            <input placeholder="latitude" type="text" id="coordLat">

            <button id="button">Enter</button>

            <br>
            <br>

            <p id="locationlong"></p>
            <p id="locationlat"></p>
          </div>

          <!-- map -->
          <div id="map"></div>

          <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>
          <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-app-compat.js"></script>
          <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-firestore-compat.js"></script>
          <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-auth-compat.js">
          <script type ="module" src="style.js"></script>
          </script>


        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
        <script>
            // JS


            var button = document.getElementById('button')
            var userLong = document.getElementById('coordLong')
            var userLat = document.getElementById('coordLat')
            var pLong = document.getElementById('locationlong')
            var pLat = document.getElementById('locationlat')
            var pName = document.getElementById('pName')
            var petName = document.getElementById('petName')
            var description = document.getElementById('description')



            // Set pet name
            petName.addEventListener("keyup", function(event) {
              var name = event.target.value
              pName.innerHTML = name;
            });




            // collect coordinates once button is clicked
            button.addEventListener("click", function() {
              console.log(userLong.value)
              console.log(userLat.value)
              var userLongTrans = userLong.value
              var userLatTrans = userLat.value
              localStorage.setItem('long-trans', userLongTrans)
              localStorage.setItem('lat-trans', userLatTrans)


              pLong.innerHTML = "Longitude: " + userLongTrans
              pLat.innerHTML = "Latitude: " + userLatTrans

              petMarker(userLong.value, userLat.value) // use the coordinates to add a marker to the map
            })

            //limit the map, make the user unable to move the pin, search cookies


            // Map
            var map = L.map('map').setView([42.63, 5], 2);

            // map layer
            L.tileLayer('https://api.maptiler.com/maps/streets-v2/{z}/{x}/{y}.png?key=5IU2Ey7QYWG2kvuuhBzs', {

                // min zoom
                minZoom: 2,

                // attribution
                attribution: '<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>'

            }).addTo(map)


            // icon


            // make markers
            function petMarker(long, lat) {
              var marker = L.marker([long, lat], {draggable: true}).addTo(map) // add marker to the map
              marker.bindPopup(petName.value + "<br>" + description.value, {closeOnClick: false, autoClose: false}).openPopup() // add pet name to the marker and make sure it's open


              // make marker bounce when clicked
              marker.on("click", function() {
                var pos = map.latLngToLayerPoint(marker.getLatLng());
                pos.y -= 20;
                var y = new L.PosAnimation();

                y.once('end',function() {
                    pos.y += 20;
                    y.run(marker._icon, pos, 0.5); // go down time
                });

                y.run(marker._icon, pos, 0.5); // go up time
              });


              marker.on('dblclick', function() {map.removeLayer(marker)}) // double click to remove marker
            }



        </script>
        <!-- <script type ="module" src="style.js"></script> -->
    </body>
</html>
